import java.nio.charset.StandardCharsets;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.HexFormat;
import java.util.Scanner;

public class SHA1 {

    // Compute SHA-1 hash (hex string) for a given message using MessageDigest + HexFormat
    public static String computeSHA1(String message) {
        try {
            MessageDigest md = MessageDigest.getInstance("SHA-1");
            byte[] digest = md.digest(message.getBytes(StandardCharsets.UTF_8));
            // HexFormat.of().formatHex produces lowercase hex; use .toUpperCase() if you want uppercase
            return HexFormat.of().formatHex(digest);
        } catch (NoSuchAlgorithmException e) {
            // SHA-1 is always present in standard Java; this is a safeguard.
            throw new RuntimeException("SHA-1 algorithm not available", e);
        }
    }

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in, StandardCharsets.UTF_8);

        System.out.println("SHA-1 Message Integrity Demonstration");

        // Step 1: Sender inputs message
        System.out.print("\nEnter message to send: ");
        String message = sc.nextLine();

        // Step 2: Sender computes hash
        String senderHash = computeSHA1(message);
        System.out.println("\n[SENDER SIDE]");
        System.out.println("Original Message : " + message);
        System.out.println("Computed SHA-1 Hash : " + senderHash);

        // Step 3: Simulate sending message over the network
        String receivedMessage = message; // unchanged for demonstration

        // Step 4: Receiver computes hash
        String receiverHash = computeSHA1(receivedMessage);
        System.out.println("\n[RECEIVER SIDE]");
        System.out.println("Received Message  : " + receivedMessage);
        System.out.println("Computed SHA-1 Hash : " + receiverHash);

        // Step 5: Compare both hashes
        System.out.println("\n[VERIFICATION RESULT]");
        if (senderHash.equals(receiverHash)) {
            System.out.println("Message integrity verified — message not altered during transmission.");
        } else {
            System.out.println("Message integrity failed — message was modified in transit.");
        }

        // Optional: Demonstrate tampering effect
        System.out.println("\nDemonstration of message tampering:");
        String tamperedMessage = receivedMessage + "!";
        String tamperedHash = computeSHA1(tamperedMessage);
        System.out.println("Tampered Message  : " + tamperedMessage);
        System.out.println("Tampered SHA-1 Hash : " + tamperedHash);

        if (!senderHash.equals(tamperedHash)) {
            System.out.println("Hash mismatch detected — message integrity compromised.");
        } else {
            System.out.println("Hashes match (unexpected) — check implementation.");
        }

        sc.close();
    }
}
